
#### Установка Manjaro XFCE ####

# Перейдем в учётную запись рута:
sudo su

# Запускаем разметку, форматирование диска и установку базовой системы:
sh -c "$(curl -fsSL https://raw.githubusercontent.com/S0u1b0y/install/Instructions/manjaro_base_bios_btrfs.sh)"
# Если вдруг, по какой-то причине, не сгенерировалось по UUID, то командой blkid смотрим UUID диска и прописываем его в fstab вместо /dev/sdaX - nano /mnt/etc/fstab.

# Чрутимся:
manjaro-chroot /mnt

# Запускаем установку и настройку основной системы:
sh -c "$(curl -fsSL https://raw.githubusercontent.com/S0u1b0y/install/Instructions/manjaro_system_bios_btrfs.sh)"
# Тоже самое для VirtualBox:
sh -c "$(curl -fsSL https://raw.githubusercontent.com/S0u1b0y/install/Instructions/manjaro_system_bios_btrfs_vbox.sh)"

# Запускаем установку XFCE:
sh -c "$(curl -fsSL https://raw.githubusercontent.com/S0u1b0y/install/Instructions/manjaro_install_xfce.sh)"

# Завершаем установку, выходим (Ctrl+D) и перезагружаемся:
reboot

#-----------------------------------------------------------------

## После перезагрузки ##

# Автозагрузка LXDM:
sudo sed -i 's/# autologin=dgod/autologin=user/' /etc/lxdm/lxdm.conf

# Создаем каталоги пользователя в домашней папке на английском языке:
sudo pacman --noconfirm -S xdg-user-dirs
LC_ALL=C xdg-user-dirs-update --force
# То же самое, но на русском языке:
sudo pacman --noconfirm -S xdg-user-dirs
xdg-user-dirs-update --force

# Ananicy - Распределяет ресурсы между задачами и управляет приоритетами приложений,
# Nohang - Следит за потреблением озу, выгружая ненужные процессы,
# Шрифты, иконки и курсоры:
yay --noconfirm -S ananicy && sudo systemctl enable --now ananicy
yay --noconfirm -S nohang && sudo systemctl enable --now nohang
yay --noconfirm -S qogir-icon-theme nerd-fonts-hack

#-----------------------------------------------------------------

## ZSH ##

# Oh My Zsh:
sh -c "$(wget -O- https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"

# Плагины и тема:
sudo git clone https://github.com/zsh-users/zsh-syntax-highlighting.git \
    $ZSH_CUSTOM/plugins/zsh-syntax-highlighting
sudo git clone https://github.com/zsh-users/zsh-completions \
    $ZSH_CUSTOM/plugins/zsh-completions
sudo git clone https://github.com/zsh-users/zsh-autosuggestions \
    $ZSH_CUSTOM/plugins/zsh-autosuggestions
sudo git clone --depth=1 https://github.com/romkatv/powerlevel10k.git \
    $ZSH_CUSTOM/themes/powerlevel10k

# Изменим кофиг zsh:
cp ~/.zshrc ~/.zshrc.bak
echo -e 'export ZSH="/home/${USER}/.oh-my-zsh"
\nDISABLE_MAGIC_FUNCTIONS="true"
COMPLETION_WAITING_DOTS="true"
DISABLE_UNTRACKED_FILES_DIRTY="true"
ZSH_AUTOSUGGEST_MANUAL_REBIND=1
POWERLEVEL9K_INSTANT_PROMPT=quiet
\nZSH_THEME="powerlevel10k/powerlevel10k"
plugins=(git docker sudo extract zsh-syntax-highlighting zsh-completions zsh-autosuggestions)
\nsource $ZSH/oh-my-zsh.sh' > ~/.zshrc
source ~/.zshrc
p10k configure #{Y,Y,Y,Y - 3,1,2 - 1,1,1 - 2,3,4,4 - 1,2,1 - Y,1,Y}

# Настроим тему:
cp ~/.p10k.zsh ~/.p10k.zsh.bak
echo -e '
############ POWERLEVEL THEME SETTINGS ##############

POWERLEVEL9K_OS_ICON_BACKGROUND=white
POWERLEVEL9K_OS_ICON_FOREGROUND=blue

POWERLEVEL9K_USER_DEFAULT_BACKGROUND=240
POWERLEVEL9K_USER_DEFAULT_FOREGROUND=white
POWERLEVEL9K_USER_ROOT_BACKGROUND=240
POWERLEVEL9K_USER_ROOT_FOREGROUND=red

POWERLEVEL9K_HOST_REMOTE_BACKGROUND=red
POWERLEVEL9K_HOST_REMOTE_FOREGROUND=black
POWERLEVEL9K_HOST_LOCAL_BACKGROUND=011
POWERLEVEL9K_HOST_LOCAL_FOREGROUND=black

############ END OF POWERLEVEL THEME SETTINGS ##############' >> ~/.p10k.zsh
sed -i 's/# os identifier/# os identifier\n    user\t\t    # username\n    host\t\t    # hostname/' ~/.p10k.zsh
source ~/.p10k.zsh

#-----------------------------------------------------------------

## Tilix ##
echo -e '\n#Для терминала Tilix
if [[ $TILIX_ID ]]; then
        source /etc/profile.d/vte.sh
fi' >> ~/.zshrc
source ~/.zshrc

# Алиасы:
echo -e '
#### Aliases ####

#Переопеделение Pacman для установки и удаления без подтверждения:
alias spacman="sudo pacman --noconfirm"

#Удаление неиспользуемых пакетов (Если нечего удалять, вылезет "ошибка: аргумент "-" указан с пустым stdin", это нормально).
alias autoremove="sudo pacman --noconfirm -Qtdq | sudo pacman --noconfirm -Rns -"
alias фгещкуьщму="sudo pacman --noconfirm -Qtdq | sudo pacman --noconfirm -Rns -"

#Быстрое обновление (pup - Pacman UPdate)
alias pup="sudo pacman -Syu"
alias згз="sudo pacman -Syu"

#Пинг делает только 5 запросов.
alias ping="ping -c 5"' >> ~/.zshrc
source ~/.zshrc
